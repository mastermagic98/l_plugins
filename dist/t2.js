(()=>{var e={430:()=>{}},a={};function t(r){var i=a[r];if(void 0!==i)return i.exports;var n=a[r]={exports:{}};return e[r](n,n.exports,t),n.exports}t.d=(e,a)=>{for(var r in a)t.o(a,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:a[r]})},t.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={};t.r(e);var a={};t.r(a),t.d(a,{y:()=>s});var r=t(430);function i(e){if(!e)return"-";var a=new Date(e);return String(a.getDate()).padStart(2,"0")+"."+String(a.getMonth()+1).padStart(2,"0")+"."+a.getFullYear()}function n(e,a){this.build=function(){if(this.card=Lampa.Template.get("trailer",e),this.img=this.card.find("img")[0],this.is_youtube="rating"===a.type,this.rating=e.vote_average?e.vote_average.toFixed(1):"-",this.trailer_lang="",this.release_date="-",this.is_youtube)this.card.find(".card__title").text(e.name),this.card.find(".card__details").remove();else{var t=((e.release_date||e.first_air_date||"0000")+"").slice(0,4),r=e.title||e.name||e.original_title||e.original_name;this.card.find(".card__title").text(r),this.card.find(".card__details").text(t+" - "+(e.original_title||e.original_name)),"-"!==this.rating?this.card.find(".card__view").append('<div class="card__rating">'+this.rating+"</div>"):this.card.find(".card__view").append('<div class="card__rating">-</div>'),this.card.find(".card__view").append('<div class="card__trailer-lang"></div>'),this.card.find(".card__view").append('<div class="card__release-date"></div>')}},this.cardImgBackground=function(a){return Lampa.Storage.field("background")?"poster"===Lampa.Storage.get("background_type","complex")&&window.innerWidth>790?a.backdrop_path?Lampa.Api.img(a.backdrop_path,"original"):this.is_youtube?"https://img.youtube.com/vi/"+e.id+"/hqdefault.jpg":"":a.backdrop_path?Lampa.Api.img(a.backdrop_path,"w500"):this.is_youtube?"https://img.youtube.com/vi/"+e.id+"/hqdefault.jpg":"":""},this.image=function(){var e=this;this.img.onload=function(){e.card.addClass("card--loaded")},this.img.onerror=function(){e.img.src="./img/img_broken.svg"}},this.loadTrailerInfo=function(){var t=this;this.is_youtube||this.trailer_lang||r.Api.videos(e,(function(n){var o,l=n.results?n.results.filter((function(e){return"Trailer"===e.type})):[],s=(0,r.getPreferredLanguage)(),d=l.find((function(e){return s.includes(e.iso_639_1)}))||l[0];if(t.trailer_lang=d?d.iso_639_1:"-","-"!==t.trailer_lang?t.card.find(".card__trailer-lang").text(t.trailer_lang.toUpperCase()):t.card.find(".card__trailer-lang").text("-"),"in_theaters"===a.type||"upcoming_movies"===a.type)if(e.release_details&&e.release_details.results){var c="uk"===(o=Lampa.Storage.get("language","ru"))?"UA":"ru"===o?"RU":"US",p=e.release_details.results.find((function(e){return e.iso_3166_1===c}));if(p&&p.release_dates&&p.release_dates.length){var u=p.release_dates[0].release_date;t.release_date=i(u)}else e.release_date&&(t.release_date=i(e.release_date))}else e.release_date&&(t.release_date=i(e.release_date));else"new_series_seasons"!==a.type&&"upcoming_series"!==a.type||e.release_details&&e.release_details.first_air_date&&(t.release_date=i(e.release_details.first_air_date));t.card.find(".card__release-date").text(t.release_date)}),(function(){t.trailer_lang="-",t.card.find(".card__trailer-lang").text("-"),t.card.find(".card__release-date").text("-")}))},this.play=function(a){if(a)try{if(Lampa.Manifest.app_digital>=183){var t={title:Lampa.Utils.shortText(e.title||e.name,50),id:a,youtube:!0,url:"https://www.youtube.com/watch?v="+a,icon:'<img class="size-youtube" src="https://img.youtube.com/vi/'+a+'/default.jpg" />',template:"selectbox_icon"};Lampa.Player.play(t),Lampa.Player.playlist([t])}else Lampa.YouTube.play(a)}catch(e){Lampa.Noty.show("Помилка відтворення трейлера: "+e.message)}else Lampa.Noty.show(Lampa.Lang.translate("trailers_no_trailers"))},this.create=function(){var a=this;this.build(),this.card.on("hover:focus",(function(t,r){Lampa.Background.change(a.cardImgBackground(e)),a.onFocus(t.target,e,r),a.loadTrailerInfo()})).on("hover:enter",(function(){a.is_youtube?a.play(e.id):r.Api.videos(e,(function(e){var t=(0,r.getPreferredLanguage)(),i=e.results?e.results.filter((function(e){return"Trailer"===e.type})):[],n=i.find((function(e){return t.includes(e.iso_639_1)}))||i[0];n&&n.key?("uk"===t[0]&&"uk"!==n.iso_639_1&&"en"!==n.iso_639_1?Lampa.Noty.show(Lampa.Lang.translate("trailers_no_ua_trailer")):"ru"===t[0]&&"ru"!==n.iso_639_1&&"en"!==n.iso_639_1&&Lampa.Noty.show(Lampa.Lang.translate("trailers_no_ru_trailer")),a.play(n.key)):Lampa.Noty.show(Lampa.Lang.translate("trailers_no_trailers"))}),(function(){Lampa.Noty.show(Lampa.Lang.translate("trailers_no_trailers"))}))})).on("hover:long",(function(){if(!a.is_youtube){var t=[{title:Lampa.Lang.translate("trailers_view"),view:!0}];Lampa.Loading.start((function(){r.Api.clear(),Lampa.Loading.stop()})),r.Api.videos(e,(function(i){Lampa.Loading.stop();var n=(0,r.getPreferredLanguage)(),o=i.results?i.results.filter((function(e){return"Trailer"===e.type})):[];o.length&&(t.push({title:Lampa.Lang.translate("title_trailers"),separator:!0}),o.forEach((function(e){e.key&&n.includes(e.iso_639_1)&&t.push({title:e.name||"Trailer",id:e.key,subtitle:e.iso_639_1})}))),Lampa.Select.show({title:Lampa.Lang.translate("title_action"),items:t,onSelect:function(t){Lampa.Controller.toggle("content"),t.view?Lampa.Activity.push({url:"",component:"full",id:e.id,method:e.name?"tv":"movie",card:e,source:"tmdb"}):a.play(t.id)},onBack:function(){Lampa.Controller.toggle("content")}})}),(function(){Lampa.Loading.stop(),Lampa.Noty.show(Lampa.Lang.translate("trailers_no_trailers"))}))}})),this.image(),this.loadTrailerInfo()},this.destroy=function(){this.img.onerror=null,this.img.onload=null,this.img.src="",this.card.remove(),this.card=null,this.img=null},this.visible=function(){this.visibled||("rating"===a.type?this.img.src="https://img.youtube.com/vi/"+e.id+"/hqdefault.jpg":e.backdrop_path?this.img.src=Lampa.Api.img(e.backdrop_path,"w500"):e.poster_path?this.img.src=Lampa.Api.img(e.poster_path):this.img.src="./img/img_broken.svg",this.visibled=!0)},this.render=function(){return this.card}}function o(e){var a,t=this,i=new Lampa.Scroll({mask:!0,over:!0}),o=[],l=$("<div></div>"),s=0;this.create=function(){return i.render().addClass("trailers-full"),r.Api.full(e,(function(r){if((r.results||[]).forEach((function(t,r){var l=new n(t,{type:e.type});l.create(),o.push(l),i.append(l.render()),0===r&&(a=l.card,l.card.addClass("card--focus"))})),r.total_pages>r.page){var l=Lampa.Template.get("more",{}),d=new n(l,{type:"more"});d.create(),(l=d.render()).addClass("selector"),l.on("hover:enter",(function(){Lampa.Activity.push({url:e.url,title:e.title,component:"trailers_full",type:e.type,page:r.page+1})})),i.append(l),o.push(d)}i.onWheel=function(e){e>0&&s<o.length-1?t.right():e<0&&s>0&&t.left()},t.toggle()}),(function(){Lampa.Noty.show(Lampa.Lang.translate("trailers_no_data"))})),l.append(i.render()),l},this.left=function(){s>0&&(s--,a=o[s].card,Lampa.Controller.moveTo(a,i.render()),i.scrollTo(a))},this.right=function(){s<o.length-1&&(s++,a=o[s].card,Lampa.Controller.moveTo(a,i.render()),i.scrollTo(a))},this.toggle=function(){Lampa.Controller.add("trailers_full",{toggle:function(){Lampa.Controller.collectionSet(i.render()),a&&Lampa.Controller.collectionFocus(a,i.render())},left:function(){t.left()},right:function(){t.right()},up:function(){Lampa.Controller.toggle("menu")},down:function(){Lampa.Controller.toggle("content")},back:function(){Lampa.Controller.toggle("menu")}}),Lampa.Controller.toggle("trailers_full")},this.render=function(){return l},this.destroy=function(){i.destroy(),o.forEach((function(e){e.destroy()})),l.remove()}}function l(a){var t=this,i=new Lampa.Scroll({mask:!0,over:!0}),n=[],o=$("<div></div>");this.create=function(){return i.render().addClass("trailers-main"),r.Api.main((function(a){a.forEach((function(a){var t=new e.Line(a);t.create(),n.push(t),i.append(t.render())})),t.toggle()}),(function(){Lampa.Noty.show(Lampa.Lang.translate("trailers_no_data"))})),o.append(i.render()),o},this.start=function(){Lampa.Controller.toggle("trailers_main")},this.toggle=function(){Lampa.Controller.add("trailers_main",{toggle:function(){Lampa.Controller.collectionSet(i.render()),Lampa.Controller.collectionFocus(!1,i.render())},up:function(){Lampa.Controller.toggle("menu")},down:function(){Lampa.Controller.toggle("content")},back:function(){Lampa.Controller.toggle("menu")}}),Lampa.Controller.toggle("trailers_main")},this.render=function(){return o},this.destroy=function(){i.destroy(),n.forEach((function(e){e.destroy()})),o.remove()}}function s(){Lampa.Template.add("trailer",['<div class="card card--trailer selector">','    <div class="card__view">','        <img class="card__img" />',"    </div>",'    <div class="card__info">','        <div class="card__title"></div>','        <div class="card__details"></div>',"    </div>","</div>"].join("")),Lampa.Template.add("items_line",['<div class="items-line">','    <div class="items-line__header">','        <div class="items-line__title"></div>',"    </div>",'    <div class="items-line__body"></div>',"</div>"].join("")),Lampa.Template.add("more",['<div class="card card--more selector">','    <div class="card__view">','        <div class="card__more">','            <svg width="36" height="36" viewBox="0 0 24 24" fill="currentColor">','                <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-1.1-.9-2-2-2s-2 .9-2 2v.68C6.63 5.36 5 7.92 5 11v5l-2 2v1h18v-1l-2-2z"/>',"            </svg>","        </div>","    </div>","</div>"].join(""))}function d(){var e;window.plugin_trailers_ready||(window.plugin_trailers_ready=!0,Lampa.Lang.add(a.translations),Lampa.Component.add("trailers_main",l),Lampa.Component.add("trailers_full",o),s(),Lampa.TMDB&&Lampa.TMDB.key()?((e=$('<li class="menu__item selector"><div class="menu__ico"><svg height="70" viewBox="0 0 80 70" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M71.2555 2.08955C74.6975 3.2397 77.4083 6.62804 78.3283 10.9306C80 18.7291 80 35 80 35C80 35 80 51.2709 78.3283 59.0694C77.4083 63.372 74.6975 66.7603 71.2555 67.9104C65.0167 70 40 70 40 70C40 70 14.9833 70 8.74453 67.9104C5.3025 66.7603 2.59172 63.372 1.67172 59.0694C0 51.2709 0 35 0 35C0 35 0 18.7291 1.67172 10.9306C2.59172 6.62804 5.3025 3.2395 8.74453 2.08955C14.9833 0 40 0 40 0C40 0 65.0167 0 71.2555 2.08955ZM55.5909 35.0004L29.9773 49.5714V20.4286L55.5909 35.0004Z" fill="currentColor"/></svg></div><div class="menu__text">'+Lampa.Lang.translate("title_trailers")+"</div></li>")).on("hover:enter",(function(){Lampa.Activity.push({url:"",title:Lampa.Lang.translate("title_trailers"),component:"trailers_main",page:1})})),$(".menu .menu__list").eq(0).append(e),$("body").append(Lampa.Template.get("trailer_style",{},!0)),Lampa.Storage.listener.follow("change",(function(e){"language"===e.name&&r.Api.clear()}))):Lampa.Noty.show("TMDB API key is missing. Trailers plugin cannot be loaded."))}window.appready?d():Lampa.Listener.follow("app",(function(e){"ready"===e.type&&d()}))})()})();